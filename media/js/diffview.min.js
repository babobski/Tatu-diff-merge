var dmp=new diff_match_patch;diffview={buildView:function(params){var baseTextLines=params.baseTextLines,newTextLines=params.newTextLines,opcodes=params.opcodes,baseTextName=params.baseTextName?params.baseTextName:"Base Text",newTextName=params.newTextName?params.newTextName:"New Text",contextSize=params.contextSize,inline=0==params.viewType||1==params.viewType?params.viewType:0,inserted=0,deleted=0,changed=0,insertC=document.getElementById("insertCount"),deletedC=document.getElementById("deletedCount"),changedC=document.getElementById("changedCount");if(null==baseTextLines)throw"Cannot build diff view; baseTextLines is not defined.";if(null==newTextLines)throw"Cannot build diff view; newTextLines is not defined.";if(!opcodes)throw"Cannot build diff view; opcodes is not defined.";function celt(name,clazz,id){id=id||!1;var e=document.createElement(name);return e.className=clazz,id&&(e.id=id),e}function telt(name,text){var e=document.createElement(name);return e.appendChild(document.createTextNode(text)),e}function ctelt(name,clazz,text,cleanText){cleanText=cleanText||"";var e=document.createElement(name);return e.className=clazz,e.dataset.text=cleanText,e.appendChild(document.createTextNode(text)),e}function btelt(name,clazz,text,cleanText){cleanText=cleanText||"";var e=document.createElement(name);return e.className=clazz,e.dataset.text=cleanText,e.innerHTML=text,e}var tdata=document.createElement("thead"),node=document.createElement("tr");tdata.appendChild(node),inline?(node.appendChild(document.createElement("th")),node.appendChild(document.createElement("th")),node.appendChild(ctelt("th","texttitle",baseTextName+" vs. "+newTextName))):(node.appendChild(document.createElement("th")),node.appendChild(ctelt("th","texttitle",newTextName)),node.appendChild(document.createElement("th")),node.appendChild(ctelt("th","texttitle",baseTextName))),tdata=[tdata];var rows=[],node2;function addCells(row,tidx,tend,textLines,change){return tidx<tend?(row.appendChild(telt("th",(tidx+1).toString())),row.appendChild(ctelt("td",change,textLines[tidx].replace(/\t/g,"    "),textLines[tidx])),tidx+1):(row.appendChild(document.createElement("th")),row.appendChild(celt("td","empty")),tidx)}function addCellsSpecial(row,tidx,tend,widx,wend,change,sourceTxt,inlineDiff,last){if(tidx<tend){last&&widx--;for(var output="",e=0;e<inlineDiff.length;e++){var currDiff=inlineDiff[e];switch(currDiff[0]){case 0:output+=currDiff[1];break;case 1:last||(output=output+'<span class="ins">'+currDiff[1]+"</span>");break;case-1:last&&(output=output+'<span class="dell">'+currDiff[1]+"</span>")}}return cleanText=output,row.appendChild(telt("th",(tidx+1).toString())),row.appendChild(btelt("td",change,cleanText,sourceTxt)),tidx+1}return row.appendChild(document.createElement("th")),row.appendChild(celt("td","empty")),tidx}function addCellsInline(row,tidx,tidx2,textLines,change){row.appendChild(telt("th",null==tidx?"":(tidx+1).toString())),row.appendChild(telt("th",null==tidx2?"":(tidx2+1).toString())),row.appendChild(ctelt("td",change,textLines[null!=tidx?tidx:tidx2].replace(/\t/g,"    ")))}for(var idx=0;idx<opcodes.length;idx++){code=opcodes[idx],change=code[0];for(var b=code[3],be=code[4],n=code[1],ne=code[2],rowcnt=Math.max(be-b,ne-n),toprows=[],botrows=[],i=0;i<rowcnt;i++){if(contextSize&&opcodes.length>1&&(idx>0&&i==contextSize||0==idx&&0==i)&&"equal"==change){var jump=rowcnt-(0==idx?1:2)*contextSize;if(jump>1){if(toprows.push(node=document.createElement("tr")),b+=jump,n+=jump,i+=jump-1,node.appendChild(telt("th","...")),inline||node.appendChild(ctelt("td","skip","")),node.appendChild(telt("th","...")),node.appendChild(ctelt("td","skip","")),idx+1==opcodes.length)break;continue}}if(toprows.push(node=document.createElement("tr")),inline)"insert"==change?addCellsInline(node,null,n++,newTextLines,change):"replace"==change?(botrows.push(node2=document.createElement("tr")),b<be&&addCellsInline(node,b++,null,baseTextLines,"delete"),n<ne&&addCellsInline(node2,null,n++,newTextLines,"insert")):"delete"==change?addCellsInline(node,b++,null,baseTextLines,change):addCellsInline(node,b++,n++,baseTextLines,change);else{switch(change){case"insert":inserted++,node.classList.add("difference");break;case"replace":b<be&&n<ne?changed++:inserted++,node.classList.add("difference");break;case"delete":deleted++,node.classList.add("difference")}if("replace"==change)if(b<be&&n<ne){var cleanText=newTextLines[b].replace(/\t/g,"    ").replace(/</g,"&lt;").replace(/>/g,"&gt;"),diffText=baseTextLines[n].replace(/\t/g,"    ").replace(/</g,"&lt;").replace(/>/g,"&gt;"),inlineDiff=dmp.diff_main(diffText,cleanText);b<be?leftLines.push(newTextLines[b]):leftLines.push("@empty@"),n<ne?rightLines.push(baseTextLines[n]):rightLines.push("@empty@"),b=addCellsSpecial(node,b,be,n,ne,change,newTextLines[b],inlineDiff,!1),n=addCellsSpecial(node,n,ne,b,be,change,baseTextLines[n],inlineDiff,!0)}else b<be?leftLines.push(newTextLines[b]):leftLines.push("@empty@"),n<ne?rightLines.push(baseTextLines[n]):rightLines.push("@empty@"),b=addCells(node,b,be,newTextLines,"insert"),n=addCells(node,n,ne,baseTextLines,change);else b<be?leftLines.push(newTextLines[b]):leftLines.push("@empty@"),n<ne?rightLines.push(baseTextLines[n]):rightLines.push("@empty@"),b=addCells(node,b,be,newTextLines,change),n=addCells(node,n,ne,baseTextLines,change)}}for(var i=0;i<toprows.length;i++)rows.push(toprows[i]);for(var i=0;i<botrows.length;i++)rows.push(botrows[i])}for(var idx in mergeResult=rightLines,insertC.innerHTML=inserted,changedC.innerHTML=changed,deletedC.innerHTML=deleted,0===inserted&&0===changed&&0===deleted&&(window.NO_CHANGES=!0),tdata.push(node=document.createElement("tbody")),rows)rows.hasOwnProperty(idx)&&node.appendChild(rows[idx]);for(var idx in node=celt("table","diff"+(inline?" inlinediff":""),"diff"),tdata)tdata.hasOwnProperty(idx)&&node.appendChild(tdata[idx]);return node}};